<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ipTIME ê·œì¹™ ì¶”ê°€</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#f5f6f8;--card:#fff;--primary:#4a7c59;--pl:#e8f0eb;--pd:#3a6247;
  --accent:#e8913a;--al:#fff4e8;--danger:#d9534f;
  --text:#1a1a2e;--ts:#6b7280;--border:#e5e7eb;
  --sh:0 1px 3px rgba(0,0,0,.06);--sh-md:0 4px 12px rgba(0,0,0,.08);--sh-lg:0 12px 40px rgba(0,0,0,.15);
  --r:14px;--rs:8px;
}
body{font-family:'Noto Sans KR',-apple-system,sans-serif;background:#e8e8e8;color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}

/* Modal */
.modal-overlay{width:100%;max-width:520px}
.modal{background:var(--card);border-radius:18px;box-shadow:var(--sh-lg);overflow:hidden;animation:up .25s ease}
@keyframes up{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.modal-header{display:flex;align-items:center;justify-content:space-between;padding:22px 28px 0}
.modal-header h2{font-size:18px;font-weight:700}
.modal-close{width:32px;height:32px;border:none;background:#f3f4f6;border-radius:8px;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:all .15s}
.modal-close:hover{background:#e5e7eb}
.modal-body{padding:20px 28px 28px}

/* Tabs */
.tab-group{display:flex;gap:4px;background:#f3f4f6;border-radius:10px;padding:3px;margin-bottom:20px}
.tab-btn{flex:1;padding:8px 0;text-align:center;border:none;background:transparent;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s}
.tab-btn.active{background:var(--card);color:var(--text);box-shadow:0 1px 3px rgba(0,0,0,.1);font-weight:600}

/* Form */
.form-section{margin-bottom:18px}
.form-section-title{font-size:12px;font-weight:700;color:var(--primary);margin-bottom:10px;text-transform:uppercase;letter-spacing:.5px}
.form-label{font-size:11px;color:var(--ts);font-weight:500;display:block;margin-bottom:4px}
.form-select{width:100%;padding:9px 12px;border:1.5px solid var(--border);border-radius:var(--rs);font-size:13px;font-family:inherit;outline:none;background:var(--card);cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%239CA3AF' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;transition:border .15s}
.form-select:focus{border-color:var(--primary)}
.form-input{width:100%;padding:9px 12px;border:1.5px solid var(--border);border-radius:var(--rs);font-size:13px;font-family:inherit;outline:none;background:var(--card);transition:border .15s}
.form-input:focus{border-color:var(--primary)}
.form-row{margin-bottom:12px}
.form-row-inline{display:flex;gap:10px;align-items:center;margin-bottom:12px}
.form-row-inline .form-input{flex:1}
.port-sep{color:var(--ts);font-size:14px}

/* Divider */
.divider{height:1px;background:var(--border);margin:20px 0}

/* Schedule Section */
.sched-section{background:#f9fafb;border:1.5px solid var(--border);border-radius:12px;padding:16px;margin-top:4px}
.sched-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.sched-title{font-size:13px;font-weight:700;color:var(--text)}

/* Allow/Block toggle */
.sched-mode{display:flex;gap:3px;background:#f3f4f6;border-radius:8px;padding:2px}
.sched-mode-btn{padding:5px 16px;border:none;background:transparent;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s}
.sched-mode-btn.active-allow{background:var(--primary);color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.1)}
.sched-mode-btn.active-block{background:#f3e8e8;color:#b5524f;font-weight:600;box-shadow:0 1px 3px rgba(0,0,0,.06)}
.sched-mode-btn:hover:not(.active-allow):not(.active-block){background:#e5e7eb}

/* Repeat tabs */
.repeat-tabs{display:flex;gap:4px;background:#f3f4f6;border-radius:8px;padding:3px;margin-bottom:12px}
.repeat-tab{flex:1;padding:6px 0;text-align:center;border:none;background:transparent;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s}
.repeat-tab.active{background:var(--card);color:var(--text);box-shadow:0 1px 2px rgba(0,0,0,.08);font-weight:600}

/* Day selector */
.day-presets{display:flex;gap:6px;margin-bottom:8px}
.day-preset-btn{padding:3px 10px;border:1.5px solid var(--border);border-radius:20px;background:transparent;font-size:10.5px;font-weight:500;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s}
.day-preset-btn:hover{border-color:var(--primary);color:var(--primary);background:var(--pl)}
.day-preset-btn.active{border-color:var(--primary);background:var(--primary);color:#fff}
.day-selector{display:flex;gap:5px;margin-bottom:12px}
.day-btn{width:36px;height:36px;border-radius:50%;border:2px solid var(--border);background:transparent;font-size:12px;font-weight:600;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s}
.day-btn.selected{border-color:var(--primary);background:var(--primary);color:#fff}
.day-btn:hover:not(.selected){border-color:var(--primary);color:var(--primary)}

/* Date grid */
.date-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-bottom:10px}
.date-cell{height:30px;border-radius:6px;border:1.5px solid var(--border);background:transparent;font-size:11px;font-weight:600;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s;display:flex;align-items:center;justify-content:center}
.date-cell.selected{border-color:var(--primary);background:var(--primary);color:#fff}
.date-cell:hover:not(.selected){border-color:var(--primary);color:var(--primary)}
.date-cell.last-day{background:#f3f4f6;font-size:9px;grid-column:span 2}
.date-cell.last-day.selected{background:var(--primary)}
.date-presets{display:flex;gap:5px;margin-bottom:8px;flex-wrap:wrap}
.date-preset-btn{padding:3px 9px;border:1.5px solid var(--border);border-radius:20px;background:transparent;font-size:10.5px;font-weight:500;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s}
.date-preset-btn:hover{border-color:var(--primary);color:var(--primary);background:var(--pl)}
.date-preset-btn.active{border-color:var(--primary);background:var(--primary);color:#fff}

/* Time */
.time-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.time-inputs{display:flex;align-items:center;gap:8px}
.time-input-wrap{flex:1}
.time-input-wrap label{font-size:10px;color:var(--ts);font-weight:500;display:block;margin-bottom:3px}
.time-input{width:100%;padding:8px 10px;border:1.5px solid var(--border);border-radius:var(--rs);font-size:13px;font-family:inherit;outline:none;transition:border .15s;background:var(--card)}
.time-input:focus{border-color:var(--primary)}
.time-sep{font-size:16px;color:#d1d5db;margin-top:14px}
.allday-msg{padding:8px 10px;background:#fff;border:1px solid var(--border);border-radius:8px;font-size:11px;color:var(--ts);text-align:center}
.allday-label{display:flex;align-items:center;gap:5px;cursor:pointer;font-size:11px;color:var(--ts);user-select:none}
.allday-label input{accent-color:var(--primary)}

/* Summary */
.schedule-summary{margin-top:12px;padding:10px 12px;border-radius:10px;background:linear-gradient(135deg,#f0fdf4,#ecfdf5);border:1px solid rgba(74,124,89,.15);display:flex;align-items:flex-start;gap:8px;transition:all .3s ease;min-height:38px}
.schedule-summary.empty{background:#fff;border-color:var(--border)}
.schedule-summary-icon{font-size:14px;flex-shrink:0;line-height:1.4}
.schedule-summary-text{font-size:11.5px;font-weight:500;color:var(--text);line-height:1.5}
.schedule-summary.empty .schedule-summary-text{color:var(--ts)}
.summary-highlight{color:var(--primary);font-weight:700}
.summary-dim{color:var(--ts);font-weight:400;font-size:11px}

/* Footer */
.modal-footer{display:flex;align-items:center;justify-content:flex-end;gap:10px;padding:16px 28px;border-top:1px solid var(--border);background:#fafbfc;border-radius:0 0 18px 18px}
.btn-cancel{padding:9px 22px;border:1.5px solid var(--border);border-radius:var(--rs);background:var(--card);font-size:13px;font-weight:500;cursor:pointer;font-family:inherit;color:var(--ts);transition:all .15s}
.btn-cancel:hover{background:#f3f4f6}
.btn-save{padding:9px 28px;border:none;border-radius:var(--rs);background:var(--primary);font-size:13px;font-weight:600;cursor:pointer;font-family:inherit;color:#fff;transition:all .15s}
.btn-save:hover{background:var(--pd)}

/* Collapsed sections */
.collapsible-header{display:flex;align-items:center;justify-content:space-between;cursor:pointer;user-select:none;padding:2px 0}
.collapsible-header .chevron{font-size:10px;color:#b0b5bf;transition:transform .2s}
.collapsible-header .chevron.open{transform:rotate(180deg)}
.collapsible-body{overflow:hidden;max-height:0;opacity:0;transition:max-height .3s ease,opacity .2s}
.collapsible-body.open{max-height:600px;opacity:1;margin-top:8px}
</style>
</head>
<body>

<div class="modal-overlay">
<div class="modal">
  <div class="modal-header">
    <h2>ê·œì¹™ ì¶”ê°€</h2>
    <button class="modal-close">âœ•</button>
  </div>
  <div class="modal-body">

    <!-- Tab -->
    <div class="tab-group">
      <button class="tab-btn active">ì¸í„°ë„· ì‚¬ìš© ì œí•œ</button>
      <button class="tab-btn">ì‚¬ì´íŠ¸ ì ‘ì† ì œí•œ</button>
    </div>

    <!-- ëª©ì ì§€ ë°©í–¥ -->
    <div class="form-section">
      <div class="collapsible-header" onclick="toggleSection(this)">
        <span class="form-section-title" style="margin:0">ëª©ì ì§€ / IP ì„¤ì •</span>
        <span class="chevron">â–¼</span>
      </div>
      <div class="collapsible-body">
        <div class="form-row" style="margin-top:4px">
          <label class="form-label">ëª©ì ì§€ ë°©í–¥</label>
          <select class="form-select"><option>ë‚´ë¶€ â†’ ì™¸ë¶€</option><option>ì™¸ë¶€ â†’ ë‚´ë¶€</option></select>
        </div>
        <div class="form-row">
          <label class="form-label">ëª©ì ì§€ í¬íŠ¸</label>
          <select class="form-select"><option>ì™¸ë¶€ ëª©ì ì§€ ALL</option></select>
        </div>
        <div class="form-row-inline">
          <input class="form-input" placeholder="" style="text-align:center">
          <span class="port-sep">~</span>
          <input class="form-input" placeholder="" style="text-align:center">
        </div>
        <div class="form-row">
          <label class="form-label">ë‚´ë¶€ IP / MAC</label>
          <select class="form-select"><option>ëª¨ë“  ë‚´ë¶€ IP</option></select>
        </div>
        <div class="form-row">
          <input class="form-input" placeholder="">
        </div>
        <div class="form-row">
          <label class="form-label">ì™¸ë¶€ IPì£¼ì†Œ</label>
          <select class="form-select"><option>ëª¨ë“  ì™¸ë¶€ IP</option></select>
        </div>
        <div class="form-row">
          <input class="form-input" placeholder="">
        </div>
      </div>
    </div>

    <div class="divider"></div>

    <!-- ìŠ¤ì¼€ì¤„ -->
    <div class="form-section" style="margin-bottom:0">
      <div class="form-section-title">ìŠ¤ì¼€ì¤„</div>
      <div class="sched-section">

        <!-- í—ˆìš©/ì°¨ë‹¨ + ë°˜ë³µ ëª¨ë“œ -->
        <div class="sched-header">
          <div class="sched-mode">
            <button class="sched-mode-btn active-allow" onclick="setMode(this,'allow')">í—ˆìš©</button>
            <button class="sched-mode-btn" onclick="setMode(this,'block')">ì°¨ë‹¨</button>
          </div>
          <div class="repeat-tabs" style="margin:0;flex:0 0 auto;width:auto;gap:2px">
            <button class="repeat-tab active" onclick="switchRepeat('weekly',this)" style="padding:5px 14px">ë§¤ì£¼</button>
            <button class="repeat-tab" onclick="switchRepeat('monthly',this)" style="padding:5px 14px">ë§¤ì›”</button>
          </div>
        </div>

        <!-- ë§¤ì£¼: ìš”ì¼ ì„ íƒ -->
        <div id="panelWeekly">
          <div class="day-presets" id="dayPresets">
            <button class="day-preset-btn" onclick="applyPreset('weekdays',this)">í‰ì¼</button>
            <button class="day-preset-btn" onclick="applyPreset('weekend',this)">ì£¼ë§</button>
            <button class="day-preset-btn active" onclick="applyPreset('everyday',this)">ë§¤ì¼</button>
          </div>
          <div class="day-selector" id="daySelector"></div>
        </div>

        <!-- ë§¤ì›”: ë‚ ì§œ ì„ íƒ -->
        <div id="panelMonthly" style="display:none">
          <div class="date-presets" id="datePresets">
            <button class="date-preset-btn" onclick="applyDatePreset('first',this)">ë§¤ì›” 1ì¼</button>
            <button class="date-preset-btn" onclick="applyDatePreset('mid',this)">ë§¤ì›” 15ì¼</button>
            <button class="date-preset-btn" onclick="applyDatePreset('firstlast',this)">1ì¼ &amp; ë§ì¼</button>
          </div>
          <div class="date-grid" id="dateGrid"></div>
        </div>

        <!-- ì‹œê°„ ì„¤ì • -->
        <div class="time-header">
          <span class="form-label" style="margin:0">ì‹œê°„ ì„¤ì •</span>
          <label class="allday-label">
            <input type="checkbox" id="allDayCheck" onchange="toggleAllDay()" checked> 24ì‹œê°„
          </label>
        </div>
        <div class="time-inputs" id="timeInputsWrap" style="display:none">
          <div class="time-input-wrap"><label>ì‹œì‘</label><input type="time" class="time-input" id="timeStart" value="00:00" oninput="updateSummary()"></div>
          <div class="time-sep">~</div>
          <div class="time-input-wrap"><label>ì¢…ë£Œ</label><input type="time" class="time-input" id="timeEnd" value="23:59" oninput="updateSummary()"></div>
        </div>
        <div class="allday-msg" id="allDayMsg">â° 24ì‹œê°„ ì „ì²´ì— ì ìš©ë©ë‹ˆë‹¤</div>

        <!-- ìš”ì•½ -->
        <div class="schedule-summary" id="scheduleSummary">
          <span class="schedule-summary-icon">ğŸ”</span>
          <span class="schedule-summary-text" id="summaryText"><span class="summary-highlight">ë§¤ì¼</span> ì¢…ì¼ <span style="color:var(--primary);font-weight:600">í—ˆìš©</span></span>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <button class="btn-cancel">ì·¨ì†Œ</button>
    <button class="btn-save">ì¶”ê°€</button>
  </div>
</div>
</div>

<script>
var dayLabels=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
var presets={weekdays:[1,2,3,4,5],weekend:[0,6],everyday:[0,1,2,3,4,5,6]};
var curRepeatMode='weekly';
var curMode='allow';

// Init days
(function(){
  var ds=document.getElementById('daySelector');
  dayLabels.forEach(function(d,i){
    var b=document.createElement('button');b.className='day-btn selected';b.textContent=d;
    b.onclick=function(){this.classList.toggle('selected');syncPresetHighlight();updateSummary()};
    ds.appendChild(b);
  });
})();

// Date grid
(function(){
  var g=document.getElementById('dateGrid');
  for(var d=1;d<=31;d++){var b=document.createElement('button');b.className='date-cell';b.textContent=d;b.dataset.date=d;b.onclick=function(){this.classList.toggle('selected');syncDatePresetHighlight();updateSummary()};g.appendChild(b)}
  var last=document.createElement('button');last.className='date-cell last-day';last.textContent='ë§ì¼';last.dataset.date='last';last.onclick=function(){this.classList.toggle('selected');syncDatePresetHighlight();updateSummary()};g.appendChild(last);
})();

function setMode(btn,mode){
  curMode=mode;
  var btns=btn.parentElement.querySelectorAll('.sched-mode-btn');
  btns.forEach(function(b){b.classList.remove('active-allow','active-block')});
  btn.classList.add(mode==='allow'?'active-allow':'active-block');
  updateSummary();
}

function switchRepeat(mode,btn){
  curRepeatMode=mode;
  var tabs=btn.parentElement.querySelectorAll('.repeat-tab');
  tabs.forEach(function(b){b.classList.remove('active')});btn.classList.add('active');
  document.getElementById('panelWeekly').style.display=mode==='weekly'?'':'none';
  document.getElementById('panelMonthly').style.display=mode==='monthly'?'':'none';
  updateSummary();
}

function applyPreset(key,btn){
  var btns=document.querySelectorAll('#dayPresets .day-preset-btn');
  var wasActive=btn.classList.contains('active');
  btns.forEach(function(b){b.classList.remove('active')});
  var dayBtns=document.querySelectorAll('#daySelector .day-btn');
  if(wasActive){dayBtns.forEach(function(b){b.classList.remove('selected')})}
  else{btn.classList.add('active');var sel=presets[key];dayBtns.forEach(function(b,i){b.classList.toggle('selected',sel.includes(i))})}
  updateSummary();
}

function syncPresetHighlight(){
  var sel=[];document.querySelectorAll('#daySelector .day-btn').forEach(function(b,i){if(b.classList.contains('selected'))sel.push(i)});
  var btns=document.querySelectorAll('#dayPresets .day-preset-btn');btns.forEach(function(b){b.classList.remove('active')});
  var s=sel.slice().sort().join(',');
  if(s===presets.weekdays.slice().sort().join(','))btns[0].classList.add('active');
  else if(s===presets.weekend.slice().sort().join(','))btns[1].classList.add('active');
  else if(s===presets.everyday.slice().sort().join(','))btns[2].classList.add('active');
}

function getSelectedDates(){var sel=[];document.querySelectorAll('#dateGrid .date-cell.selected').forEach(function(c){sel.push(c.dataset.date)});return sel}
function setSelectedDates(arr){document.querySelectorAll('#dateGrid .date-cell').forEach(function(c){c.classList.toggle('selected',arr.includes(c.dataset.date)||arr.includes(parseInt(c.dataset.date)))})}
function applyDatePreset(key,btn){
  var btns=document.querySelectorAll('#datePresets .date-preset-btn');var wasActive=btn.classList.contains('active');
  btns.forEach(function(b){b.classList.remove('active')});
  document.querySelectorAll('#dateGrid .date-cell').forEach(function(c){c.classList.remove('selected')});
  if(!wasActive){btn.classList.add('active');if(key==='first')setSelectedDates(['1']);else if(key==='mid')setSelectedDates(['15']);else if(key==='firstlast')setSelectedDates(['1','last'])}
  updateSummary();
}
function syncDatePresetHighlight(){
  var sel=getSelectedDates();var btns=document.querySelectorAll('#datePresets .date-preset-btn');
  btns.forEach(function(b){b.classList.remove('active')});var s=sel.sort().join(',');
  if(s==='1')btns[0].classList.add('active');else if(s==='15')btns[1].classList.add('active');else if(s==='1,last')btns[2].classList.add('active');
}

function toggleAllDay(){
  var on=document.getElementById('allDayCheck').checked;
  document.getElementById('timeInputsWrap').style.display=on?'none':'flex';
  document.getElementById('allDayMsg').style.display=on?'':'none';
  if(on){document.getElementById('timeStart').value='00:00';document.getElementById('timeEnd').value='23:59'}
  updateSummary();
}

function toggleSection(header){
  var body=header.nextElementSibling;var ch=header.querySelector('.chevron');
  body.classList.toggle('open');ch.classList.toggle('open');
}

function updateSummary(){
  var wrap=document.getElementById('scheduleSummary'),txt=document.getElementById('summaryText'),icon=wrap.querySelector('.schedule-summary-icon');
  var allDay=document.getElementById('allDayCheck').checked;
  var ts=document.getElementById('timeStart').value,te=document.getElementById('timeEnd').value;
  var modeText=curMode==='allow'?'<span style="color:var(--primary);font-weight:600">í—ˆìš©</span>':'<span style="color:var(--danger);font-weight:600">ì°¨ë‹¨</span>';
  var timeStr=allDay?'ì¢…ì¼':(ts&&te?ts+' ~ '+te:'');

  if(curRepeatMode==='weekly'){
    var sel=[];document.querySelectorAll('#daySelector .day-btn').forEach(function(b,i){if(b.classList.contains('selected'))sel.push(i)});
    if(sel.length===0){wrap.classList.add('empty');icon.textContent='ğŸ“…';txt.innerHTML='ìš”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”';return}
    wrap.classList.remove('empty');icon.textContent='ğŸ”';
    var s=sel.slice().sort().join(','),dayStr='';
    if(s===presets.everyday.slice().sort().join(','))dayStr='ë§¤ì¼';
    else if(s===presets.weekdays.slice().sort().join(','))dayStr='í‰ì¼(ì›”~ê¸ˆ)';
    else if(s===presets.weekend.slice().sort().join(','))dayStr='ì£¼ë§(í† Â·ì¼)';
    else dayStr='ë§¤ì£¼ '+sel.map(function(i){return dayLabels[i]}).join('Â·');
    txt.innerHTML='<span class="summary-highlight">'+dayStr+'</span> '+timeStr+' '+modeText;
  }else{
    var dates=getSelectedDates();
    if(dates.length===0){wrap.classList.add('empty');icon.textContent='ğŸ“…';txt.innerHTML='ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';return}
    wrap.classList.remove('empty');icon.textContent='ğŸ“†';
    var dateStr=dates.map(function(d){return d==='last'?'ë§ì¼':d+'ì¼'}).join(', ');
    txt.innerHTML='<span class="summary-highlight">ë§¤ì›” '+dateStr+'</span> '+timeStr+' '+modeText;
  }
}
</script>
</body>
</html>
